# True Love Server Configuration Example
# ============================================
# 
# IMPORTANT: Since wxautox4 uses UIAutomation (not hook),
# all identifiers have changed from wxid to NICKNAMES!
#
# - sender: now is nickname (e.g., "纯路人") instead of wxid
# - chat_id: now is nickname/group name (e.g., "委员会") instead of roomid
#
# Please update your config accordingly.

# Base service address (base 服务地址)
base_server:
  host: "http://localhost:5000"
  # Note: self_wxid is kept for backward compatibility but may not be needed
  self_wxid: "wxid_xxx"  
  master_wxid: "wxid_xxx"  # Your wxid for notifications
  master_group: "xxx@chatroom"  # Master group roomid

http_token: "your_secret_token"

# ASR configuration (语音识别配置)
asr:
  secret_id: "your_secret_id"
  secret_key: "your_secret_key"
  asr_appid: 123456
  asr_secret_id: "your_asr_secret_id"
  asr_secret_key: "your_asr_secret_key"

# =============================================================
# NOTE: groups/privates allow_list settings have been REMOVED!
# =============================================================
# These settings are now controlled in true-love-base/config.yaml
# via the `listen_chats` configuration.
#
# Base now handles:
# - Which chats to listen to (via listen_chats)
# - Whether a chat is group or private (is_group flag)
# - When to respond (groups: only when @, private: always)
#
# Server only processes messages that base decides to forward.
# =============================================================

# ALAPI configuration (早报等 API)
alapi:
  token: "your_alapi_token"

# Loki configuration (直接访问 Grafana Cloud Loki)
loki:
  # Grafana Cloud Loki 地址 (在 Grafana Cloud -> Loki -> Details 中查看)
  loki_url: "https://logs-prod-xxx.grafana.net"
  # Grafana Cloud User ID (在 Grafana Cloud 账号设置中查看)
  user_id: "123456"
  # Grafana Cloud API Key (创建时选择 MetricsPublisher 或 logs:read 权限)
  # 获取方式: Grafana Cloud -> Access Policies -> Create access policy -> Add token
  api_key: "glc_xxxxx"
  # 要查询的服务列表 (对应日志的 service_name label)
  services: ["ai", "base", "server"]

# Auto notification settings (for scheduled notifications)
auto_notice: {}

# Reminder settings
# NOTE: Uses NICKNAMES now!
remainder:
  utc+8: []

# Chat bot configuration
enable_bot: chatgpt

# HTTP service configuration
http:
  host: "0.0.0.0"
  port: 8088
  token: ["your_token"]
  # NOTE: receiver_map values now use GROUP NAMES / NICKNAMES!
  # Example: receiver_map: {"alias": "群名称或昵称"}
  receiver_map: {}

# GitHub integration
# NOTE: allow_user now uses NICKNAMES instead of wxid!
github:
  allow_user: []
  token: "github_pat_xxx"

# Card feature
# NOTE: card_user values now use NICKNAMES instead of wxid!
card:
  card_user: {}

# Muninn integration (Muninn CDK 生成配置)
# NOTE: allow_user now uses NICKNAMES instead of wxid!
muninn:
  allow_user: []  # 允许生成 CDK 的用户昵称列表
  api_base_url: ""
  admin_token: "your_muninn_admin_token"

# Logging configuration
logging:
  version: 1
  disable_existing_loggers: False
  formatters:
    simple:
      format: "%(asctime)s %(message)s"
      datefmt: "%Y-%m-%d %H:%M:%S"
    error:
      format: "%(asctime)s %(name)s %(levelname)s %(filename)s::%(funcName)s[%(lineno)d]:%(message)s"
  handlers:
    console:
      class: logging.StreamHandler
      level: INFO
      formatter: simple
      stream: ext://sys.stdout
    info_file_handler:
      class: logging.handlers.RotatingFileHandler
      level: INFO
      formatter: simple
      filename: logs/server_info.log
      maxBytes: 10485760
      backupCount: 20
      encoding: utf8
    error_file_handler:
      class: logging.handlers.RotatingFileHandler
      level: ERROR
      formatter: error
      filename: logs/server_error.log
      maxBytes: 10485760
      backupCount: 20
      encoding: utf8
  root:
    level: INFO
    handlers: [console, info_file_handler, error_file_handler]

